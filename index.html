<!doctype html>
<html>
<head>
    <title>frb.js</title>
<style type="text/css" media="screen">
    #editor { 
        float:right;
        width:600px;
        height:600px;
    }
    #canvas {
        float:left;
        margin-left: 600px;
    }
</style>
</head>

<body>
<h1>FRB.js</h1>
<canvas id="canvas" width="800" height="600"></canvas>


<div id="editor">
frb.start({
    init: function() {
        window.emitter = new frb.Emitter();
    },
    update: function() {

        emitter.position.x = frb.InputManager.mouse.worldX;
        emitter.position.y = frb.InputManager.mouse.worldY;
        

        // recycle particles if necessary
        var list = emitter.items();
        for (var i = 0; i < list.length; i++) {
            var particle = list.get(i);
            if (particle.alpha <= 0) { 
                emitter.pool.return(particle);
                continue;
            }

            particle.alpha -= 0.05;
        };

        var newParticle = emitter.emitCircle(10);//emitSprite("Frblogo128");


        // initialize particle

        var xRange = 100;
        var gravity = -150.5;
        var direction = {x: (Math.random() * xRange) - (xRange/2), y: Math.random() * 400};

        newParticle.xVelocity = direction.x;
        newParticle.yVelocity = direction.y;

        newParticle.yAcceleration = gravity;

        
    }
});
</div>
<!--<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js" type="text/javascript"></script>-->
<script src="jquery-1.7.1.min.js" type="text/javascript"></script>
<script src="frb.js"></script>
<script src="http://d1n0x3qji82z53.cloudfront.net/src-min-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
    var editor = ace.edit("editor");
    editor.setTheme("ace/theme/monokai");
    editor.getSession().setMode("ace/mode/javascript");

    // set up the compilation thread:
    var compileWorker = new Worker('compile-thread.js');

    compileWorker.addEventListener('message', function(e) {
        // Compilation finished ... now update the UI

        frb.updateFunction = eval("(" + e.data + ")");
    }, false);

    $(function() {
        var script  = editor.getValue();

        eval(script);
    });

    editor.getSession().on('change', function() {

        var script  = editor.getValue();

        compileWorker.postMessage(script);
    });
</script>

</body>
</html>

















